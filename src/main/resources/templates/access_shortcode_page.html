<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Shortcode Dashboard</title>
    <!-- 부트스트랩 CSS 링크 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">


    <style>
        .center-div {
            margin-top: 50px;
            width: 80%;
            margin-left: auto;
            margin-right: auto;
        }
    </style>
</head>
<body>
<div class="center-div">
    <table class="table">
        <thead>
        <tr>
            <th>ShortCode</th>
            <th>View Count</th>
        </tr>
        </thead>
        <tbody id="shortcodeTableBody">
        <!-- 데이터 로드 자리 -->
        </tbody>
    </table>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    $(document).ready(function () {
        const authToken = localStorage.getItem('X-READYS-AUTH-TOKEN');
        $.ajax({
            url: '/api/v1/shorts',
            type: 'GET',
            headers: {
                'X-READYS-AUTH-TOKEN': authToken// Set Authorization header
            },
            dataType: 'json',
            success: function (data) {
                let tableBody = $('#shortcodeTableBody');
                data.data.forEach(function (item) {
                    let row = $('<tr></tr>');
                    //  '<a class="form-control" href="/' + response.data.replace("http://localhost:8080/", "") + '" target="_blank">URL: ' + response.data + '</a>' +
                    row.append(`<td><a href="/history/${item.shortcode}'"> ${item.shortcode}></a></td>`);
                    row.append(`<td>${item.view}</td>`);
                    tableBody.append(row);
                });
            },
            error: function (xhr, status, error) {
                console.error('Error fetching data: ', error);
                alert('Failed to fetch data. Check console for more details.');
            }
        });
    });
</script>
</body>
</html>
